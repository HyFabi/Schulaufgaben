package at.maurutschek.rekursionen.liederbaum.data;

/**
 * LiederBaum - Eine Klasse welches einen Liederbaum implementiert und Methoden zur verfÃ¼gung stellt.
 * @author Fabian Maurutschek
 *
 */
public class LiederBaum {
	LiederBaumKnoten root;

	/**
	 * Konstruktor
	 * @param l: Der Erste Liederbaumknoten
	 */
	public LiederBaum(Lied l) {
		this.root = new LiederBaumKnoten(l);
	}

	/**
	 * Defaultkonstruktor besitzt am Anfang kein einziges Element
	 */
	public LiederBaum() {
		this.root = null;
	}

	/**
	 * 
	 * @param l
	 * @return
	 * @throws Exception
	 */
	public boolean vorhanden(Lied l) throws Exception {
		if (l == null)
			throw new Exception();
		if (this.root == null)
			return false;
		return vorhanden(this.root, l);
	}

	/**
	 * 
	 * @param lbk
	 * @param l
	 * @return
	 */
	private boolean vorhanden(LiederBaumKnoten lbk, Lied l) {
		if (lbk.getLied().equals(l))
			return true;
		if (lbk.getLinks() != null)
			return vorhanden(lbk.getLinks(), l);
		if (lbk.getRechts() != null)
			return vorhanden(lbk.getRechts(), l);
		return false;
	}

	/**
	 * 
	 * @param l
	 * @return
	 * @throws Exception
	 */
	public boolean add(Lied l) throws Exception {
		if (l == null)
			throw new Exception();
		if (vorhanden(l))
			return false;
		if (this.root == null)
			this.root = new LiederBaumKnoten(l);
		return add(this.root, l);
	}

	/**
	 * 
	 * @param lbk
	 * @param l
	 * @return
	 */
	private boolean add(LiederBaumKnoten lbk, Lied l) {
		if (lbk.getLied().getTitel().compareTo(l.getTitel()) > 0) {
			if (lbk.getLinks() != null)
				return add(lbk.getLinks(), l);
			lbk.setLinks(new LiederBaumKnoten(l));
			return true;
		}
		if (lbk.getLied().getTitel().compareTo(l.getTitel()) < 0) {
			if (lbk.getRechts() != null)
				return add(lbk.getRechts(), l);
			lbk.setRechts(new LiederBaumKnoten(l));
			return true;
		}
		return false;
	}

	/**
	 * 
	 * @throws Exception
	 */
	public void ausgeben() throws Exception {
		if (this.root == null)
			throw new Exception();
		ausgeben(this.root);
	}

	/**
	 * 
	 * @param lbk
	 */
	private void ausgeben(LiederBaumKnoten lbk) {
		if (lbk.getLinks() != null)
			ausgeben(lbk.getLinks());
		if (lbk.getRechts() != null)
			ausgeben(lbk.getRechts());
		System.out.println(lbk.getLied().toString());
	}

	/**
	 * 
	 * @return
	 * @throws Exception
	 */
	public long sumLiederLaenge() throws Exception {
		if (this.root == null)
			throw new Exception();
		return sumLiederLaenge(this.root, 0);
	}

	/**
	 * 
	 * @param lbk
	 * @param x
	 * @return
	 */
	private long sumLiederLaenge(LiederBaumKnoten lbk, long x) {
		if (lbk.getLinks() != null)
			x = sumLiederLaenge(lbk.getLinks(), x);
		if (lbk.getRechts() != null)
			x = sumLiederLaenge(lbk.getRechts(), x);
		x += lbk.getLied().getLaenge();
		return x;
	}
}
